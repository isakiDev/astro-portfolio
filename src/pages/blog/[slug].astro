---
import { getCollection, getEntry, render } from "astro:content";

import Layout from "@app/layouts/Layout.astro";
import Wrapper from "@app/layouts/Wrapper.astro";
import Breadcrumb from "@shared/components/ui/Breadcrumb.astro";

export async function getStaticPaths() {
  const articles = await getCollection("blog", ({ data }) => {
    return data.draft === false;
  });

  return articles.map((article) => ({
    params: { slug: article.slug },
  }));
}

const { slug } = Astro.params;

const article = await getEntry("blog", slug);

if (!article) {
  return Astro.redirect("/404");
}

const { Content } = await render(article);

const breadcrumbs = [
  { name: "Inicio", href: "/" },
  { name: "Blog", href: "/blog/page/1" },
  { name: article.data.title },
];
---

<Layout
  title={`${article.data.title} | Blog - Gaspar Castillo - Software Developer`}
>
  <Wrapper>
    <Breadcrumb breadcrumbs={breadcrumbs} />
    <Content />
  </Wrapper>
</Layout>
